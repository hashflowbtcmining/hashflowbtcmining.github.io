<!-- Transactions -->
<div class="card">
<h2>Recent Activity</h2>
<div style="max-height:200px; overflow-y:auto;" id="txContainer">
  <table id="tx"></table>
</div>
</div>

<script>
// Keep track of transactions to avoid duplicates
let displayedTxs = {};

// Update transactions from Blockchain.com API
function updateTransactions(txs){
  const txTable = document.getElementById("tx");
  const txContainer = document.getElementById("txContainer");
  
  txs.forEach(tx=>{
    const txHash = tx.hash;
    if(displayedTxs[txHash]) return;
    displayedTxs[txHash] = true;

    const row = document.createElement("tr");
    const amountCell = document.createElement("td");
    const statusCell = document.createElement("td");

    let value = tx.out.reduce((sum,o)=>sum + (o.addr===address?o.value:0),0)/1e8;
    amountCell.innerText = (value>0? "+" : "") + value.toFixed(8) + " BTC";
    statusCell.innerText = tx.block_height ? "Completed" : "Pending";
    statusCell.className = tx.block_height ? "green" : "yellow";

    row.appendChild(amountCell);
    row.appendChild(statusCell);
    txTable.prepend(row);
    
    // Auto-scroll newest transaction into view
    txContainer.scrollTop = 0;
  });
}
</script>
